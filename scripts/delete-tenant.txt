
-- Delete tenant no. 10, assuming there are no DW1_PAGE_ACTIONS rows.

delete from dw1_logins where tenant = '10';
delete from dw1_ids_openid where tenant = '10';
delete from dw1_quotas where tenant = '10';
delete from dw1_users where tenant = '10';
delete from dw1_tenant_hosts where tenant = '10';
delete from dw1_tenants where id = '10';


-- Delete tenant 'new-website', assuming there are no DW1_PAGE_ACTIONS rows.

\set AUTOCOMMIT 'off'
do $$
declare website_id varchar(32);
begin
  select id into strict website_id from dw1_tenants where name = 'new-website';
  
  raise notice 'Deleting website with id %...', website_id;

  delete from dw1_logins where tenant = website_id;
  delete from dw1_ids_openid where tenant = website_id;
  delete from dw1_quotas where tenant = website_id;
  delete from dw1_users where tenant = website_id;
  delete from dw1_tenant_hosts where tenant = website_id;
  delete from dw1_tenants where id = website_id;

  raise notice '...Done. You need to commit manually.';
end $$;

-- And, optionally:
commit;

